<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=description content><link rel=icon href=/myriad/images/favicon.png type=image/png><title>Configuration And Plugins :: Myriad</title>
<link href=/myriad/css/nucleus.css?1714905267 rel=stylesheet><link href=/myriad/css/fontawesome-all.min.css?1714905267 rel=stylesheet><link href=/myriad/css/featherlight.min.css?1714905267 rel=stylesheet><link href=/myriad/css/perfect-scrollbar.min.css?1714905267 rel=stylesheet><link href=/myriad/css/auto-complete.css?1714905267 rel=stylesheet><link href=/myriad/css/theme.css?1714905267 rel=stylesheet><link href=/myriad/css/tabs.css?1714905267 rel=stylesheet><link href=/myriad/css/hugo-theme.css?1714905267 rel=stylesheet><script src=/myriad/js/jquery.min.js?1714905267></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/myriad/docs/tutorials/configuration/><nav id=sidebar><div id=header-wrapper><div id=header><h1>Myriad</h1></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/myriad/js/lunr.min.js?1714905267></script><script src=/myriad/js/auto-complete.js?1714905267></script><script>var index_url="/myriad/index.json",root_url="/",baseUri=root_url.replace(/\/$/,"")</script><script src=/myriad/js/search.js?1714905267></script></div><div id=homelinks><ul><li><a class=padding href=/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/myriad/docs/ title=Docs class="dd-item parent"><a href=/myriad/docs/><i class='fas fa-book'></i>Docs</a><ul><li data-nav-id=/myriad/docs/tutorials/ title=Tutorials class="dd-item parent alwaysopen"><a href=/myriad/docs/tutorials/><b>1. </b>Tutorials</a><ul><li data-nav-id=/myriad/docs/tutorials/configuration/ title="Configuration And Plugins" class="dd-item active"><a href=/myriad/docs/tutorials/configuration/><i class='fas fa-cog'></i> Configuration And Plugins</a></li><li data-nav-id=/myriad/docs/tutorials/debugging/ title=Debugging class=dd-item><a href=/myriad/docs/tutorials/debugging/><i class='fas fa-bug'></i> Debugging</a></li><li data-nav-id=/myriad/docs/tutorials/external-plugins/ title="External Plugins" class=dd-item><a href=/myriad/docs/tutorials/external-plugins/><i class='fas fa-external-link-alt'></i> External Plugins</a></li><li data-nav-id=/myriad/docs/tutorials/msbuild-usage/ title="MSBuild usage" class=dd-item><a href=/myriad/docs/tutorials/msbuild-usage/><i class='fab fa-microsoft'></i> MSBuild usage</a></li></ul></li><li data-nav-id=/myriad/docs/plugins/ title=Plugins class="dd-item alwaysopen"><a href=/myriad/docs/plugins/><b>2. </b>Plugins</a><ul><li data-nav-id=/myriad/docs/plugins/record-fields/ title=Records class=dd-item><a href=/myriad/docs/plugins/record-fields/><i class='fas fa-compact-disc'></i> Records</a></li><li data-nav-id=/myriad/docs/plugins/du-extensions/ title="Discriminated Unions" class=dd-item><a href=/myriad/docs/plugins/du-extensions/><i class='far fa-object-group'></i> Discriminated Unions</a></li><li data-nav-id=/myriad/docs/plugins/lenses/ title=Lenses class=dd-item><a href=/myriad/docs/plugins/lenses/><i class='fas fa-camera'></i> Lenses</a></li></ul></li><li data-nav-id=/myriad/docs/external-resources/ title="External resources" class=dd-item><a href=/myriad/docs/external-resources/><i class='fas fa-cog'></i> External resources</a></li></ul></li><li data-nav-id=/myriad/blog/ title=News class=dd-item><a href=/myriad/blog/>News</a><ul></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://moiraesoftware.github.io/myriad/tags><i class='fas fa-tags'></i> Tags</a></li><li><a class=padding href=https://github.com/MoiraeSoftware/myriad><i class='fab fa-github'></i> GitHub</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="4"><a itemprop=item href=/myriad/><span itemprop=name>About Myriad</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/myriad/docs/><span itemprop=name>Docs</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/myriad/docs/tutorials/><span itemprop=name>Tutorials</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/myriad/docs/tutorials/configuration/ aria-disabled=true><span itemprop=name>Configuration And Plugins</span></a></li></ol></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div></div><div id=head-tags></div><main id=body-inner><h1>Configuration And Plugins</h1><h1 id=configuration>Configuration</h1><p>Myriad uses a configuration file called <code>myriad.toml</code> which uses the <a href=https://toml.io/en/>toml format</a>. Myriad looks in the current directory fro this file but it can be configured by placing <code>MyriadConfigFile</code> in your project file like this:</p><pre tabindex=0><code class=language-msbuild data-lang=msbuild>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;Project Sdk=&#34;Microsoft.NET.Sdk&#34;&gt;
  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;net6.0&lt;/TargetFramework&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;MyriadConfigFile&gt;myConfig.toml&lt;/MyriadConfigFile&gt;
  &lt;/PropertyGroup&gt;
...
</code></pre><p>The configuration section for the built in plugins is very simple, the configuration name or key is passed in by either the plugins generator attribute, in the case of the fields plugin:</p><pre tabindex=0><code>[&lt;Generator.Fields &#34;fields&#34;&gt;]
type Test1 = { one: int; two: string; three: float; four: float32 }
</code></pre><p>The configuration key is &ldquo;fields&rdquo;, if we now look at the <code>myriad.toml</code> file it looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>fields</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>namespace</span> = <span style=color:#e6db74>&#34;TestFields&#34;</span>
</span></span></code></pre></div><p>You can see that there is a <code>namespace</code> key that is set to &ldquo;TestFields&rdquo;. Using an attribute like this you can configure your plugin to take further information on how to generate the code.</p><p>There is another mechanism of specifying what configuration a plugin will use and that is by using an MSBuild property <code>MyriadConfigKey</code> as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Compile</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;ArbitaryFile.fs&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;MyriadFile&gt;</span>Test.txt<span style=color:#f92672>&lt;/MyriadFile&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;MyriadConfigKey&gt;</span>example1<span style=color:#f92672>&lt;/MyriadConfigKey&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Compile&gt;</span>
</span></span></code></pre></div><p>The configuration key <code>example1</code> would be passed to the plugin so that it could be consumed. This is used in the <code>Myriad.Plugin.Example1</code> plugin and use uses configuration to specify the <code>namespace</code> used.</p><h1 id=writing-plugins-to-consume-configuration>Writing plugins to consume configuration</h1><p>The plugin interface receives this key via: <code>GeneratorContext</code> . <code>ConfigKey</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fsharp data-lang=fsharp><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>GeneratorContext</span> <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    ConfigKey<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> option
</span></span><span style=display:flex><span>    ConfigGetter<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>string</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>obj</span><span style=color:#f92672>)</span> seq
</span></span><span style=display:flex><span>    InputFilename<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>IMyriadGenerator</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>member</span> ValidInputExtensions<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> seq
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>member</span> Generate<span style=color:#f92672>:</span> GeneratorContext <span style=color:#f92672>-&gt;</span> FsAst.AstRcd.SynModuleOrNamespaceRcd <span style=color:#66d9ef>list</span>
</span></span></code></pre></div><p>ValidInputExtensions is used so a plugin is tied to certain file types as input, if you plugin generating ast fragments from java files then you would add <code>.java</code> to the <code>ValidInputExtensions</code> implementation for example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fsharp data-lang=fsharp><span style=display:flex><span>    <span style=color:#66d9ef>interface</span> IMyriadGenerator <span style=color:#66d9ef>with</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>member</span> __.<span style=color:#a6e22e>ValidInputExtensions</span> <span style=color:#f92672>=</span> seq <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;.java&#34;</span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//...
</span></span></span></code></pre></div><p>While we are discussing the <code>IMyriadGenerator</code> interface lets discuss the <code>Generate</code> member:</p><p>Generate takes a <code>GeneratorContext</code> which contains the <code>ConfigKey</code> as mentioned above, the <code>ConfigGetter</code> : <code>string -> (string * obj) seq</code> which is a mean to allow access to the <code>myriad.toml</code> file, you give the function the configuration ket you wish to receive and it returns the configuration. Finally a <code>InputFilename</code> is also passed in so you can load or parse your input files ready to generate an AST. If you look at the included plugins you can see the mechanism for extracting and building AST fragments for reference.</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/myriad/docs/tutorials/ title=Tutorials><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/myriad/docs/tutorials/debugging/ title=Debugging><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/myriad/js/clipboard.min.js?1714905267></script><script src=/myriad/js/perfect-scrollbar.min.js?1714905267></script><script src=/myriad/js/perfect-scrollbar.jquery.min.js?1714905267></script><script src=/myriad/js/jquery.sticky.js?1714905267></script><script src=/myriad/js/jquery.svg.pan.zoom.js?1714905267></script><script src=/myriad/js/featherlight.min.js?1714905267></script><script src=/myriad/js/modernizr.custom-3.6.0.js?1714905267></script><script src=/myriad/js/mermaid.min.js?1714905267></script><script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/myriad/js/relearn.js?1714905267></script></body></html>